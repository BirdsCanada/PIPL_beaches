---
title: "ProcessingData"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

To Do:
-get a number for each beach that shows the amount of land within the buffer (exclude sea)
-finalize buffer size
-process landuse data
-reformat with physical data
-process survey data into format for analysis
-visualize
-pca of survey variables


percentage of the landuse categories is based off land area present within the buffer, not including ocean or water bodies within.
```{r landuse plots}
ggplot(beachPhys, aes(tot_area_km, color = landclass))+ geom_histogram()+facet_wrap(~landclass, scales = "free")

ggplot(beachPhys, aes(landclass, tot_area_km, colour = landclass))+ geom_boxplot()+facet_wrap(~Region)
```


```{r big dataset}
#Need to fix goose haven in this dataset
beachPhysW<-beachPhys %>% 
  pivot_wider(names_from = landclass, values_from = c(tot_area_km, tot_area, percentage)) %>% 
  select(-12,-17,-19,-22)

beachData<-full_join(prodData, beachPhysW, by = c('BeachID', 'Length_km', 'Region')) %>% 
  distinct()

#this may not be very useful
data<-full_join((piplSurvey %>% 
  select(name,year:day,19, 31:63) %>% 
  rename(BeachID = name, Year = year)), beachData,  by = c('BeachID', 'Year'))

data[data == ""] <- NA #just fixing missing values formatting

```


I messed around with prcomp but I'm getting an error about missing/infinite values even when omitting NAs, which reminded me nmds with bray curtis is better for null values which we have
```{r nmds?}
library(vegan)
#change columns to numeric if going into a pca
cols.num <- c(2,5:38,40:45,47:49,51:62)
data[cols.num] <- sapply(data[cols.num],as.numeric)

data_mat<-data %>% 
  select(c(2,5:38,40:45,47:49,51:62)) %>% 
  filter_all(any_vars(. != 0))
#NEED to sum columns to look for only 0 columns
data %>% 
  select(c(2,5:38,40:45,47:49,51:62)) %>% 
  filter_all(any_vars(. != 0))

metaMDS(data_mat, k = 2, na.rm = TRUE, distance="bray")

test<-data %>% 
  group_by(BeachID) %>% 
  summarize(sum = sum(is.na(Management)))
test2<-data %>% 
  select(1, 50)
```











